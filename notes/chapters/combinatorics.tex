% \chapauthor{J. P. Balthasar Mueller}
\chapter{Combinatorics}

\begin{multicols}{2}[\subsubsection*{Contents of this chapter}]
   \printcontents{}{1}{\setcounter{tocdepth}{2}}
\end{multicols}



\section{Useful Expressions}

% binomial coefficients
\subsection{Binomial Coefficients and Binomial Expansions}

For two positive integers $n$ and $k$, the binomial coefficient "$n$ choose $k$" is:

\begin{equation}
{n \choose k} = \left\{ \begin{array}{c} 
\frac{n!}{k!(n-k)!}\ \ \mathrm{for\ }n\geq k\\
\\
0 \ \ \mathrm{otherwise}
\end{array}\right.
\end{equation}

The term can be defined for negative arguments, which is comes up often when working with generating functions.

\begin{equation}
{-n \choose k} = \left\{\begin{array}{c}
(-1)^k { n+k-1 \choose k}\ \ \mathrm{for\ }n\geq k\\
\\
0 \ \ \mathrm{otherwise}
\end{array}\right.
\end{equation}


\begin{equation}
{-n \choose -k} = \left\{\begin{array}{c}
(-1)^{k-n} {k-1 \choose k-n}\ \ \mathrm{for\ }n\geq k\\
\\
0 \ \ \mathrm{otherwise}
\end{array}\right.
\end{equation}

The generalizations can, for example, be derived using symmetry arguments and the Gamma function, which is the generalization of the factorial to non-integers (cf.  \citeasnoun{kronenburg2011binomial}).


% Binomial Expansion
The binomial expansion can be proven either by expanding the polynomial or by creating the Taylor series for the polynomial.

\begin{equation}
(x + y)^n = \sum_{k=0}^n {n \choose k} x^k y^{n-k}
\end{equation}

This holds also for negative integer exponents $n$, in which case:

\begin{equation}
\frac{1}{(y+x)^n} = \sum_{k=0}^\infty {-n \choose k} x^k y^{-n-k} = (-1)^k { n+k-1 \choose k} x^k y^{-(n+k)}
\end{equation}

\subsubsection{Derivation of the Binomial Theorem for a Negative Exponent}

Let $f(x) = \frac{1}{(y+x)^n} = (y+x)^{-n}$. The Taylor expansion about the point $x=0$ is:

\begin{equation}
f(x) = \sum_{k=0}^\infty \frac{f^{(k)}(x=0)}{k!} x^k
\label{eq:taylor}
\end{equation}

The derivatives of $f$ are:

\begin{equation}
\begin{array}{ll}
f^{(0)}(x) &= (y+x)^{-n}\\
f^{(1)}(x) &= (y+x)^{-(n+1)}(-1)n\\
f^{(2)}(x) &= (y+x)^{-(n+2)}(-1)^2 n(n+1)\\
&\vdots\\
f^{(k)}(x) &= (y+x)^{-(n+k)}(-1)^k n(n+1)\hdots	(n+k-1)\\
&=  (y+x)^{-(n+k)}(-1)^k \frac{(n+k-1)!}{(n-1)!}
\end{array}
\label{eq:derivatives}
\end{equation} 

Combing Eqns. \ref{eq:taylor} and \ref{eq:derivatives} gives:

\begin{equation}
f(x) = \sum_{k=0}^\infty (-1)^k {n+k-1 \choose k} x^k y^{-(n+k)}
\end{equation}


\subsubsection{Derivation of the Binomial Theorem for a Fractional Exponent}

Following much the same logic as for a negative exponent, for a fractional exponent the Taylor series is also infinite. 

Let $f(x) = (y+x)^{m}$ with $m\notin \mathbb{Z}$. 

The derivatives of $f$ are:

\begin{equation}
\begin{array}{ll}
f^{(0)}(x) &= (y+x)^{m}\\
f^{(1)}(x) &= (y+x)^{m-1}m\\
f^{(2)}(x) &= (y+x)^{m-2}m(m-1)\\
&\vdots\\
f^{(k)}(x) &= (y+x)^{n-k}m(m-1)\hdots	(m-k+1)\\
\end{array}
\label{eq:derivatives2}
\end{equation} 

Combing Eqns. \ref{eq:taylor} and \ref{eq:derivatives2} gives:

\begin{equation}
f(x) = \sum_{k=0}^\infty { m \choose k } x^k y^{m-k}
\end{equation}

Where, boldly, I defined ${ m \choose k}$ to mean:

\begin{equation}
{m \choose k} = \frac{m(m-1)(m-2)\hdots(m-k+2)(m-k+1)}{k!}
\end{equation}


% Multinomial Expansion
\subsection{Multinomial Expansion}

\begin{equation}
(x_1 + x_2 + x_3 + \hdots + x_k)^n = \sum_{\begin{array}{c} i_1,i_2,i_3,\hdots,i_k \\ \sum_j i_j = n\end{array}} {n \choose i_1,i_2,\hdots i_k}x^{i_1}x^{i_2}x^{i_3}\hdots x^{i_k}
\end{equation}

with:

\begin{equation}
{n \choose i_1,i_2,\hdots i_k} = \frac{n!}{i_1!i_2!,i_3!\hdots i_k!}
\end{equation}

Where the sum over all possible exponents $i_j$ so that $\sum_j i_j = n$ has ${n+k-1 \choose n}$ terms. 

\subsection{Unnamed Polynomial Identity}
I don't know what this is called, but it's useful.

\begin{equation}
\prod_i^n (1-x_i) = \sum_{s=0}^{n} (-1)^s \sum_{0\leq \underbrace{i_1,i_2,...,i_s }_{\{i\}_s} \leq n} \prod_{i \in \{i\}_s} x_i
\end{equation}

Where $\{i\}_s$ is a set of $s$ indices that range between $0$ and $n$, and the sum is over all possible such sets, of which there are ${n \choose s}$.  


% Factorial Expansion
\subsection{Factorial Expansion}

\begin{equation}
x^{\underline{n}} = \frac{x!}{(x-n)!} = \sum_{k=0}^n s(n,k)x^k
\end{equation}

where

\begin{equation}
s(n,k) = (-1)^{n-k}\left[\begin{array}{c} n\\k \end{array}\right]
\end{equation}

are the stirling numbers of the first kind.



% Stirling Numbers of the second kinds
\subsection{Stirling Numbers of the Second Kind}
\label{sec:stirling2}

Stirling numbers of the second kind $S(k,n)$ measure the amount of ways in which $k$ objects can be divided into $n$ non-empty groups. They give the number of onto functions from a set of $k$ distinct objects to $n$ indistinct recipients. For example: how many ways can a set of $k$ pool balls be put into $n$ bags, so that there is at least one ball in each bag. All the pool balls have numbers on them and have different colors, so that $n=2$ bags containing $[(1,2,3), (4)] $ and $[(1,2,4),(3)]$ count as different. This sort of problem is discussed at length in section \ref{twentyfoldway}

They are given by an explicit formula:

\begin{equation}
S(k,n) = \frac{1}{n!}\sum_{i=1}^n (-1)^{n-j} {n \choose j}j^k
\end{equation}

They can also be generated via the recurrence relation:

\begin{equation}
\left\{\begin{array}{c}k+1\\n\end{array}\right\} = n\left\{\begin{array}{c}k\\n\end{array}\right\} + \left\{\begin{array}{c}k\\n-1\end{array}\right\}
\end{equation}

The recurrence relation is explained by adding the combinations corresponding to two cases. If the $k+1$st object is added to one of the $n$ existing subsets with $k$ objects, then that corresponds to:

\begin{equation}
n\left\{\begin{array}{c}k\\n\end{array}\right\} = 1
\end{equation}

Possbilities. If the $k+1$st object is in a set by itself (a singleton), then the remaining objects are distributed over $n-1$ set. The combinations arising from this are:

\begin{equation}
\left\{\begin{array}{c}k\\n-1\end{array}\right\} = 1
\end{equation}

Furthermore, the following holds:

\begin{equation}
\left\{\begin{array}{c}0\\0\end{array}\right\} = 1
\end{equation}

\begin{equation}
\left\{\begin{array}{c}k\\0\end{array}\right\} = \left\{\begin{array}{c}0\\n\end{array}\right\} = 0
\end{equation}

And $S(k,n) = 0$ if $n>k$.


\input{./chapters/sections/comb_twentyfoldway.tex}
\input{./chapters/sections/comb_generatingfuncs.tex}

