% \chapauthor{J. P. Balthasar Mueller}
\chapter{Combinatorics}

\begin{multicols}{2}[\subsubsection*{Contents of this chapter}]
   \printcontents{}{1}{\setcounter{tocdepth}{2}}
\end{multicols}



\section{Useful Expansions and Identities}
% Binomial Expansion
\subsection{Binomial Expansion}

\begin{equation}
(x + y)^n = \sum_{i=0}^n {n \choose i} x^{n-i}y^i
\end{equation}

with:

\begin{equation}
{n \choose k} = \frac{n!}{k!(n-k)!}
\end{equation}

\subsection{Multinomial Expansion}

\begin{equation}
(x_1 + x_2 + x_3 + \hdots + x_k)^n = \sum_{\begin{array}{c} i_1,i_2,i_3,\hdots,i_k \\ \sum_j i_j = n\end{array}} {n \choose i_1,i_2,\hdots i_k}x^{i_1}x^{i_2}x^{i_3}\hdots x^{i_k}
\end{equation}

with:

\begin{equation}
{n \choose i_1,i_2,\hdots i_k} = \frac{n!}{i_1!i_2!,i_3!\hdots i_k!}
\end{equation}

Where the sum over all possible exponents $i_j$ so that $\sum_j i_j = n$ has ${n+k-1 \choose n}$ terms. 

\subsection{Polynomial Identity}
I don't know what this is called, but it's useful.

\begin{equation}
\prod_i^n (1-x_i) = \sum_{s=0}^{n} (-1)^s \sum_{0\leq \underbrace{i_1,i_2,...,i_s }_{\{i\}_s} \leq n} \prod_{i \in \{i\}_s} x_i
\end{equation}

Where $\{i\}_s$ is a set of $s$ indices that range between $0$ and $n$, and the sum is over all possible such sets, of which there are ${n \choose s}$.  

\subsection{Factorial Expansion}

\begin{equation}
x^{\underline{n}} = \frac{x!}{(x-n)!} = \sum_{k=0}^n s(n,k)x^k
\end{equation}

where

\begin{equation}
s(n,k) = (-1)^{n-k}\left[\begin{array}{c} n\\k \end{array}\right]
\end{equation}



% Twentyfold Way
\section{The Twentyfold Way}

The twentyfold way is a taxonomy of distribution problems developed by Kenneth Bogard in his book \textit{Combinatorics through Guided Discovery}. It divides up the way in which $k$ objects may be assigned to $n$ individuals, subject to whether the objects are distinct or identical, and subject to conditions on how the objects are received.


\begin{quote}
\textit{When we are passing out objects to recipients, we may think of the objects as being either identical or distinct. We may also think of the recipients as being either identical (as in the case of putting fruit into plastic bags in the grocery store) or distinct (as in the case of passing fruit out to children). We may restrict the distributions to those that give at least one object to each recipient, or those that give exactly one object to each recipient, or those that give at most one object to each recipient, or we may have no such restrictions. If the objects are distinct, it may be that the order in which the objects are received is relevant (think about putting books onto the shelves in a bookcase) or that the order in which the objects are received is irrelevant (think about dropping a handful of candy into a child?s trick or treat bag). If we ignore the possibility that the order in which objects are received matters, we have created $2\times2\times4 = 16$ distribution problems. In the cases where a recipient can receive more than one distinct object, we also have four more problems when the order objects are received matters. Thus we have 20 possible distribution problems.} - Bogart, \textit{Combinatorics Though Guided Discovery}, Chapter 3.
\end{quote}


What I like about this approach is that the challenge with most of the basic combinatorics problems is to figure out the right way of counting. For this reason, the idea of having a unified handbook-like taxonomy is very appealing. The weakness (in my opinion) is that the language of "objects" and "recipients" is unclear because in practice it's not obvious which is which: if there are $k$ students and $n$ teachers, do the teachers receive students, or do the students receive a teacher? 

A way to resolve this is to say that an object can have only one recipient, but that a recipient might receive more than one object. A more formal path is to think of the act of creating combinations in terms of functions. 

\begin{itemize}
\item The elements of the domain are the objects. 
\item The elements of the range are the recipients. 
\item A function can be many-to-one, but it should not be one-to-many. 
\end{itemize}

\subparagraph{Favorite Teachers} At a school with $k$ students and $n$ teachers, the students all have a favorite teacher. (They might all like the same one.). How many ways are there for all of the $k$ students to pick a favorite? 

\textit{Objects:} $k$ students. \textit{Recipients:} $n$ teachers. Many students might have one favorite teacher. There are $n^k$ combinations. 

\subparagraph{Assembling a Team} Out of a choice of $n$ athletes, a coach must assemble a team of $k$. How many ways are there to form a team? 

\textit{Objects:} n athletes. \textit{Recipients:} team, not on the team. Many athletes can be assigned to one outcome of being on the team or not being on the team. There are ${n \choose k}$ combinations for the team, which is the same number as the ${n \choose n-k}$ selections for the bench. 

\subsection{Distinct Objects, Without Conditions}

\subsubsection{Distinct Recipients}
The $k$ objects are assigned to $n$ recipients with no conditions as to the number of objects each recipient receives. This is the same as assigning the elements of a $k$-tuple from a selection of $n$ \underline{with} replacement.

\begin{equation}	
\begin{array}{l}
S = \{ (a_1,a_2,...,a_k) | a_i \in A, |A| = n \}\\
\\
|S| = n^k
\end{array}
\end{equation}

\subparagraph{Functions} All possible functions $f:x \rightarrow y$ with $\{x | x\in A, |A| = k \}$ and $\{y | y\in B, |B| = n\}$.

\subparagraph{Binary Strings of Length $k$} The $k$ distinct positions of a binary string $(i_1,i_2,...,i_k)$ of length $k$ are assigned to an element of the set $A\in[0,1]$. The number of possible binary strings of length $k$ is $2^k$.

\subparagraph{Subsets of a $k$-Element Set} The subsets of a set of $k$ distinct elements are formed by assigning each of its $k$ distinguishable elements to one of the two labels $A\in [\mathrm{included},\mathrm{excluded}]$. The number of possible subsets, including the empty subset and the full set, is $2^k$.

\subsubsection{Indistinct Recipients}
The $k$ objects are assigned to a recipient that is not distinct. This is the same as assigning the elements of a $k$-tuple to the same value \underline{with} replacement. This case is just like the case for distinct recipients with $n=1$.
\begin{equation}	
\begin{array}{l}
S = \{ (a_1,a_2,...,a_k) | a_i = a_j\}\\
\\
|S| = 1^k
\end{array}
\end{equation}

\subparagraph{Everyone Gets A Car} How many ways are there to give a car to everyone? One. Everyone gets a car.


\subsection{Distinct Objects, Every Recipient Receives At Most One}
\subsubsection{Distinct Recipients}
At most one of $k$ distinct objects are assigned to one of $n$ distinct recipients. This is the same as assigning the elements of a $k$-tuple from a selection of $n$ \underline{without} replacement, so that first there are $n$ choices, then $n-1$ choices, $n-2$, etc...

\begin{equation}	
\begin{array}{l}
S = \{ (a_1,a_2,...,a_k) | a_i \in A, |A| = n, a_i\neq a_j\}\\
\\
|S| = \frac{n!}{(n-k)!} = n^{\underline{k}}\ \ \mathrm{if\ }k\leq n,\ 0\ \mathrm{otherwise.}
\end{array}
\end{equation}

\subparagraph{One-to-One Functions} All possible functions $f:x \rightarrow y$ with $\{x | x\in A, |A| = k \}$ and $\{y | y\in B, |B| = n\}$ subject to the constraint that $f(a) = f(b)$ implies $a=b$. That is, the functions are one-to-one, or injective.

\subparagraph{k-element Permutations of $n$ elements}  Each of the $k$ positions in a $k$-element permutation are distinct objects. These are each assigned to one of $n$ possible values, where each value can only show up once. 

\subparagraph{Books on a Shelf} How many ways are there to order $k$ books on a library shelf when there are $n$ different books available. 

\subsubsection{Indistinct Recipients}
At most one of $k$ distinct objects are assigned to one of $n$ indistinct recipients. This is the same as assigning the elements of a $k$-tuple from a selection of $n$ \underline{without} replacement. Except ,since the recipients are all indistinct, there is only one type of choice of recipient for each object. Either each object finds a recipient if $k\leq n$, or it is impossible to distribute at most one object to each recipient because $n < k$.

\begin{equation}
\begin{array}{l}
S = \{ (a_1,a_2,...,a_k) | a_i \in A, |A| = n, a_i=a_j\}\\
\\
|S| = 1\ \ \mathrm{if\ }k\leq n,\ 0\ \mathrm{otherwise.}
\end{array}
\end{equation}

\subparagraph{Distributing Candy} There are $n$ pieces of identical candy and $k$ kids. How many ways are there to give each kid a piece of candy? If there is enough candy, the answer is one. Everyone gets candy. If there is not enough candy then the answer is zero. There is no way to give everyone candy if there's not enough candy.

\subsection{Distinct Objects, Every Recipient Receives at Least One}

\subsubsection{Distinct Recipients}

\begin{equation}
|A| = n!S(k,n) =n! \left\{ \begin{array}{c} k \\n \end{array}\right\} = n! \sum_{j=0}^k (-1)^{k-j} {k \choose j }j^n
\end{equation}

Where $S(k,n)$	 denotes the Stirling function of the second kind.

\subparagraph{Onto Functions} All possible functions $f:x \rightarrow y$ with $\{x | x\in A, |A| = k \}$ and $\{y | y\in B, |B| = n\}$ subject to the constraint that there is an element $x$ in the domain so that $f(x)=y$ for each element $y$ of the codomain. That is the functions are onto, or surjective.


\subsubsection{Indistinct Recipients}
The number of ways to divide $k$ distinct objects into $n$ non-empty subets is given by the Stirling number of the second kind:

\begin{equation}
|A| = S(k,n) = \left\{ \begin{array}{c} k \\n \end{array} \right\} = \sum_{j=0}^k (-1)^{k-j} {k \choose j }j^n
\end{equation}


\subsection{Distinct Objects, Every Recipient Receives Exactly One}

\subsubsection{Distinct Recipients}
One of $k$ distinct objects are assigned to each of $n$ distinct recipients. This is the same as assigning the elements of a $k$-tuple from a selection of $n$ \underline{without} replacement and with the requirement that all of the $n$ are selected.

\begin{equation}	
\begin{array}{l}
S = \{ (a_1,a_2,...,a_k) | a_i \in A, |A| = k = n, a_i\neq a_j\}\\
\\
|S| = n! = k!\ \ \mathrm{if\ }k=n,\ 0\ \mathrm{otherwise.}
\end{array}
\end{equation}

\subparagraph{Bijective Functions} All possible functions $f:x \rightarrow y$ with $\{x | x\in A, |A| = k \}$ and $\{y | y\in B, |B| = n\}$ subject to the constraints that $f(a) = f(b)$ implies $a=b$ and that there is an element $x$ in the domain so that $f(x)=y$ for each element $y$ of the codomain. That is, the functions are one-to-one and onto, of bijective.

\subparagraph{Permutations} Since each of the $k$ objects is given to a different one of the $n$ recipients, there must be as many recipients as there are objects and $k=n$. The number of ways of assigning $k$ objects to $n$ recipients is $k!=n!$.

\subparagraph{Unique Identifiers} Each of $k$ entries in a database is given one of $n=k$ unique identifiers, so that each identifier leads to an entry and each entry has an identifier. 

\subsubsection{Indistinct Recipients}

\begin{equation}	
\begin{array}{l}
S = \{ (a_1,a_2,...,a_k) | a_i \in A, |A| = k, a_i=a_j\}\\
\\
|S| = 1\ \ \mathrm{if\ }k = n,\ 0\ \mathrm{otherwise.}
\end{array}
\end{equation}



\subparagraph{Distribute without Leftovers} $k$ students are assigned to $n$ identical textbooks. How many ways are there for each child to have a textbook so that there are no textbooks left over? 
 


\subsection{Distinct Objects, Distributed in Ordered Groups}

\subsubsection{Distinct Recipients}
$k$ objects are distributed to $n$ different recipients with an internal ordering, so that each recipient receives an ordered list. This is the same as creating a list of $n$ sequences that are sampled from $k$ \underline{without replacement}. 

\begin{equation}
\begin{array}{l}
S = \{ (\mathbf{a}_{\{i_1\}}  = ( a_{i_{1,1}},a_{i_{1,1}},...,a_{i_{1,l}} ),\mathbf{a}_{\{i_2\}},...,\mathbf{a}_{\{i_n\}}) | \sum^n_j |\mathbf{a}_{i_j}| = k, a_{i_{j,i}} \in A, |A| = n \} \\
\\
|S| = \frac{(k + n - 1)!}{(n-1)!} = ( k+n-1)^{\underline{k}} = k! {k+n-1 \choose k}
\end{array}
\end{equation}


\subparagraph{Ordered Functions}  All functions $f: x \rightarrow y$ with $\{x | x\in A, |A| = k \}$ and $\{y | y\in B, |B| = n\}$ that assign ordered sequences of elements in $x$ to elements of $y$.

\subparagraph{Labeled Bookshelves} $k$ books are distributed across $n$ different bookshelves. The books may all be on the same shelf, or shelves may be empty. The ordering of the books on each of the shelves matters.


\subsubsection{Indistinct Recipients}
$k$ objects are broken up into $n$ 

\begin{equation}
|S| = \sum_{i=1}^n L(k,i) 
\end{equation}

where $L(k,n)$ are the Lah numbers, which describe "How many ways can $k$ objects be distributed to $n$ recipients if order matters and each recipient receives at least 1". They are given by:

\begin{equation}
L(k,n)= {k \choose n} (k-1)^{\underline{k-n}} = \frac{k!}{n!}{ k-1 \choose n-1 }
\end{equation}

The sum considers the case where all $k$ objects are given to $i\leq n$ recipients, with the remaining recipients receiving none. The expression is more complicated than simply dividing the case for indistinct recipients by $n!$, because more than one of the recipients might receive the same number of objects, in which case i.e. the distribution $[(0),(0),(1,2)]$ would be counted twice.

\subparagraph{Broken Permutations $\leq n$ Parts} The permutations of $k$ distinct elements are ordered sequences of length $k$. If the sequence is cut up into \underline{up to} $n$ different parts of non-zero length, then what results are \textit{broken permutations}.

\subparagraph{Books into Boxes} $k$ different books are put into $n$ identical boxes. How many ways are there to pack the boxes if you keep track of the order in which the books in each box are stacked? 


% Distinct Objects, Distributed in Ordered Groups of At Least One
\subsection{Distinct Objects, Distributed in Ordered Groups of At Least One}

\subsubsection{Distinct Recipients}

\begin{equation}
|S| = \frac{k!}{(k-n)!}\frac{(k-1)!}{(n-1)!} = k^{\underline{n}} (k-1)^{\underline{k-n}}
\end{equation}

\subparagraph{Ordered Onto Functions} All functions $f: x \rightarrow y$ with $\{x | x\in A, |A| = k \}$ and $\{y | y\in B, |B| = n\}$ that assign ordered sequences of elements in $x$ to elements of $y$, where every element $y\in B$ has an assignment of at least one element.

\subsubsection{Indistinct Recipients}
$k$ elements are divided into $n$ ordered sequences of minimum length 1.

\begin{equation}
L(k,n)= {k \choose n} (k-1)^{\underline{k-n}} = \frac{k!}{n!}{ k-1 \choose n-1 }
\end{equation}
	
	
\subparagraph{Broken Permutations $n$ parts} The permutations of $k$ distinct elements are ordered sequences of length $k$. If the sequence is cut up into up to $n$ different parts, then what results are \textit{broken permutations}.

\subparagraph{Books into Boxes} $k$ different books are put into $n$ identical boxes, so that there is at least one book in each box. How many ways are there to pack the boxes if you keep track of the order in which the books in each box are stacked? 


% Identical Objects
\subsection{Identical Objects}

\subsubsection{Distinct Recipients}

\begin{equation}
|S| = {k+n-1 \choose k}
\end{equation}

\subparagraph{Multisets} Multisets are sets in which identical elements might show up several times. For example $\{a,a,b,b,b\}$. They can also be described in terms of the multiplicity of their elements. For example $[a:2, b:3, c:0]$. How many multisets can be formed with $k$ different elements of $n$ different classes?

\subparagraph{Integer Sums} How many different configurations of the $n$ integers $\{ x_i\}_n$ satisfy $x_1 + x_2 + ... + x_n = k$?

\subparagraph{Bosons in Degenerate States} In how many ways might $k$ Bosons populate $n$ degenerate states?


\subsubsection{Indistinct Recipients}

\begin{equation}
|S| = \sum_{i=1}^n P(k,i)
\end{equation}

It turns out that there is no known formula for $P(k,n)$!

\subparagraph{Number Partitions} How many ways are there to divide $k$ objects across \underline{up to} $n$ piles

\subparagraph{Unlabeled Multiplicities of Multisets} For multisets of $k$ elements with $n$ different classes, what is the number of possible multiplicities? For example, a multiset of $k=3$ elements from $n=2$ classes could have multiplicities $[a:3,b:0], [a:2,b:1],[a:1,b:2],[a:0,b:3]$. If we do not care about the labels $a,b$, then the ways that the the $k$ elements migth be distributed are $[3,0]$ and $[2,1]$.

\subparagraph{Boxes of Marbles} $k$ marbles are randomly put into $n$ boxes. How many ways are there for the weight to be distributed among the boxes?



% Identical Objects, Each gets at most one
\subsection{Identical Objects, Each Receives At Most One}

\subsubsection{Distinct Recipients}
$k$ identical objects are distributed across $n$ recipients so that each recipient recieves at most one. That amounts to choosing $k$ out of the $n$ recipients who will receive an object.

\begin{equation}
|S| = { n \choose k}
\end{equation}


\subparagraph{Subsets} $k$ element subsets of a set of size $n$.

\subparagraph{Binary Labels} The problem can also be thought of as assigning a binary label to $n$ elements, where there are $k$ times $1$ and $n-k$ times 0.

\subsubsection{Indistinct Recipients}

\begin{equation}
|S| = 1\ \ \mathrm{if\ }k \leq n,\ 0\ \mathrm{otherwise}
\end{equation}  

\subparagraph{Boxes} How many ways are there to put $k$ marbles in $n$ boxes, if each box is only big enough for one marble. One, if there are enough boxes, or zero, if there aren't enough boxes.


% Identical Everyone Gets At Least one
\subsection{Identical Objects, Each Receives At Least One}

\subsubsection{Distinct Recipients}
This problem is the same as giving each of $n$ recipients one of $k$ objects, and then distributing the remaining $k-n$ objects arbitrarily.  

\begin{equation}
|S| = {k+n-1-k \choose k-n}= {n-1 \choose k-1}
\end{equation}

\subparagraph{Compositions $n$ Parts} How many ways are there to assign $k$ identical objects to $n$ labeled sets of at least one object?

\subsubsection{Indistinct Recipients}

\begin{equation}
|S| = P(k,n)
\end{equation}

It turns out that there is no known formula for $P(k,n)$!

\subparagraph{Partitions in $n$ Parts} How many ways are there to make $n$ piles from $k$ objects.

% Identical Each Gets Exactly one
\subsection{Identical Objects, Each Receives Exactly One}

\subsubsection{Distinct Recipients}

\begin{equation}
|S| = 1\ \ \mathrm{if\ }k = n,\ 0\ \mathrm{otherwise}
\end{equation}  

\subsubsection{Indistinct Recipients}

\begin{equation}
|S| = 1\ \ \mathrm{if\ }k = n,\ 0\ \mathrm{otherwise}
\end{equation}  

\chapauthor{}








